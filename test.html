<!DOCTYPE html>
<html>
<head>
    <title>Test Movie Generator</title>
</head>
<body>
    <h1>Test Movie Generator</h1>
    <select id="genres">
        <option value="">Select a genre...</option>
    </select>
    <button id="playBtn">Let's Play!</button>
    <div id="movieInfo">
        <div id="moviePoster"></div>
        <div id="movieText"></div>
    </div>
    <div id="likeOrDislikeBtns" style="display:none;">
        <button id="likeBtn">üëç</button>
        <button id="dislikeBtn">üëé</button>
    </div>

    <script>
        // Simple test version
        const tmdbKey = 'fd6275bcc82b3d92530d85150045c04c';
        const tmdbBaseUrl = 'https://api.themoviedb.org/3';

        console.log('Script starting...');

        // Load genres
        async function loadGenres() {
            try {
                console.log('Loading genres...');
                const response = await fetch(`${tmdbBaseUrl}/genre/movie/list?api_key=${tmdbKey}`);
                console.log('Response status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('Genres data:', data);
                
                const select = document.getElementById('genres');
                if (select && data.genres) {
                    data.genres.forEach(genre => {
                        const option = document.createElement('option');
                        option.value = genre.id;
                        option.textContent = genre.name;
                        select.appendChild(option);
                    });
                    console.log('Dropdown populated with', data.genres.length, 'genres');
                } else {
                    console.error('Select element not found or no genres data');
                }
            } catch (error) {
                console.error('Error loading genres:', error);
            }
        }

        // Show random movie
        async function showRandomMovie() {
            const selectedGenre = document.getElementById('genres').value;
            console.log('Selected genre:', selectedGenre);
            
            if (!selectedGenre) {
                alert('Please select a genre first!');
                return;
            }
            
            try {
                console.log('Loading movies...');
                const response = await fetch(`${tmdbBaseUrl}/discover/movie?api_key=${tmdbKey}&with_genres=${selectedGenre}`);
                const data = await response.json();
                console.log('Movies data:', data);
                
                if (data.results && data.results.length > 0) {
                    const randomMovie = data.results[Math.floor(Math.random() * data.results.length)];
                    displayMovie(randomMovie);
                } else {
                    alert('No movies found!');
                }
            } catch (error) {
                console.error('Error loading movies:', error);
            }
        }

        // Display movie
        function displayMovie(movie) {
            console.log('Displaying movie:', movie);
            
            const moviePosterDiv = document.getElementById('moviePoster');
            const movieTextDiv = document.getElementById('movieText');
            const likeOrDislikeBtns = document.getElementById('likeOrDislikeBtns');
            
            moviePosterDiv.innerHTML = '';
            movieTextDiv.innerHTML = '';
            
            if (movie.poster_path) {
                const posterImg = document.createElement('img');
                posterImg.src = `https://image.tmdb.org/t/p/original/${movie.poster_path}`;
                posterImg.style.maxWidth = '300px';
                moviePosterDiv.appendChild(posterImg);
            }
            
            const title = document.createElement('h2');
            title.textContent = movie.title;
            movieTextDiv.appendChild(title);
            
            const overview = document.createElement('p');
            overview.textContent = movie.overview;
            movieTextDiv.appendChild(overview);
            
            likeOrDislikeBtns.style.display = 'block';
        }

        // Initialize when page loads
        window.addEventListener('load', function() {
            console.log('Page loaded, initializing...');
            loadGenres();
            
            document.getElementById('playBtn').addEventListener('click', showRandomMovie);
        });
    </script>
</body>
</html>
